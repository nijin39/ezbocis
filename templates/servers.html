{% extends "layout/base.html" %}
{% block title %}SSA COLLECT{% endblock %}
{% block head %}
    {{ super() }}
    <script src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css" rel="stylesheet"/>
{% endblock %}
{% block content %}
	<div class="row">
		<table id="example" class="display" cellspacing="0" width="100%">
	        <thead>
	            <tr>
	                <th>ID</th>
	                <th>Hostname</th>
	                <th>Interface ID</th>
	                <th>IP</th>
	            </tr>
	        </thead>
	        <tfoot>
	            <tr>
	                <th>ID</th>
	                <th>Hostname</th>
	                <th>Interface ID</th>
	                <th>IP</th>
	            </tr>
	        </tfoot>
	    </table>
	</div>

  <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">데이터 전송 상태</h4>
        </div>
        <div class="modal-body">
          <p id="message">성공적으로 전송되었습니다.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
      
    </div>
  </div>
  
    <!-- Modal -->
  <div class="modal fade" id="myModal2" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">데이터 전송 상태</h4>
        </div>
        <div class="modal-body">
          <p id="message2">성공적으로 전송되었습니다.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
      
    </div>
  </div>
{% endblock %}

{% block jscript %}
<script>

var accessToken = "";
var dt = "";

$(document).ready(function() {
	$("#message").text("로딩 중입니다.");
	$("#myModal").modal();
	$.get("/tenants/{{tenant}}", function(data, status){
		accessToken = data;
	}).done(function() {
		$('#myModal').modal('hide');
			
		dt = $('#example').DataTable({
		    "ajax": {
		        "url": "/servers-data",
		        "dataSrc": "data",
		        "error": function(result){
		        	$("#message2").text("권한이 필요합니다.");
		        	$("#myModal2").modal();
		        }
		    },
		    "columns": [
		        { "data": "hostid" },
		        { "data": "hostname" },
		        { "data": "interfaceid" },
		        { "data": "ip" }
		    ]
		});
		
	});
});

</script>

{% endblock %}
